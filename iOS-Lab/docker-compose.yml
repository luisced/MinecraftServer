version: "3.4"

services:
  minecraft-server:
    image: itzg/minecraft-server:java8
    ports:
      - 25565:25565/tcp
      - 25565:25565/udp
    container_name: minecraft-server
    environment:
      EULA: "TRUE"
      TYPE: FORGE
      FORGEVERSION: 36.2.39
      VERSION: 1.16.5
      OPS: "LuisGamer02031, ShadyGamer"
      OVERRIDE_SERVER_PROPERTIES: "TRUE"
      SERVER_NAME: "iOS-Lab"
      MEMORY: 20G
      MODE: "SURVIVAL"
      ONLINE_MODE: "TRUE"
      ANNOUNCE_PLAYER_ACHIEVEMENTS: "TRUE"
      ALLOW_FLIGHT: "TRUE"
      ALLOW_CHEATS: "FALSE"
      ALLOW_NETHER: "TRUE"
      OVERRIDE_ICON: "TRUE"
      MAX_PLAYERS: 50
      SEED: 3227028068011494400
      REMOVE_OLD_MODS: "FALSE"
      ICON: "https://avatars.githubusercontent.com/u/92172089?s=400&u=4019840738f526b24cf5f7b7670301ec38890900&v=4"
      MOTD: "\u00a7x\u00a7f\u00a7f\u00a76\u00a76\u00a70\u00a70\u00a7lW\u00a7x\u00a7f\u00a7f\u00a76\u00a72\u00a70\u00a7a\u00a7le\u00a7x\u00a7f\u00a7f\u00a75\u00a7e\u00a71\u00a74\u00a7ll\u00a7x\u00a7f\u00a7f\u00a75\u00a7a\u00a71\u00a7d\u00a7lc\u00a7x\u00a7f\u00a7f\u00a75\u00a76\u00a72\u00a77\u00a7lo\u00a7x\u00a7f\u00a7f\u00a75\u00a72\u00a73\u00a71\u00a7lm\u00a7x\u00a7f\u00a7f\u00a74\u00a7e\u00a73\u00a7b\u00a7le\u00a7x\u00a7f\u00a7f\u00a74\u00a7b\u00a74\u00a75\u00a7l \u00a7x\u00a7f\u00a7f\u00a74\u00a77\u00a74\u00a7e\u00a7lt\u00a7x\u00a7f\u00a7f\u00a74\u00a73\u00a75\u00a78\u00a7lo\u00a7x\u00a7f\u00a7f\u00a73\u00a7f\u00a76\u00a72\u00a7l \u00a7x\u00a7f\u00a7f\u00a73\u00a7b\u00a76\u00a7c\u00a7li\u00a7x\u00a7f\u00a7f\u00a73\u00a77\u00a77\u00a76\u00a7lO\u00a7x\u00a7f\u00a7f\u00a73\u00a73\u00a78\u00a70\u00a7lS\u00a7x\u00a7f\u00a7f\u00a72\u00a7f\u00a78\u00a79\u00a7l-\u00a7x\u00a7f\u00a7f\u00a72\u00a7b\u00a79\u00a73\u00a7lL\u00a7x\u00a7f\u00a7f\u00a72\u00a77\u00a79\u00a7d\u00a7la\u00a7x\u00a7f\u00a7f\u00a72\u00a73\u00a7a\u00a77\u00a7lb\u00a7x\u00a7f\u00a7f\u00a71\u00a7f\u00a7b\u00a71\u00a7l \u00a7x\u00a7f\u00a7f\u00a71\u00a7b\u00a7b\u00a7a\u00a7lS\u00a7x\u00a7f\u00a7f\u00a71\u00a78\u00a7c\u00a74\u00a7le\u00a7x\u00a7f\u00a7f\u00a71\u00a74\u00a7c\u00a7e\u00a7lr\u00a7x\u00a7f\u00a7f\u00a71\u00a70\u00a7d\u00a78\u00a7lv\u00a7x\u00a7f\u00a7f\u00a70\u00a7c\u00a7e\u00a72\u00a7le\u00a7x\u00a7f\u00a7f\u00a70\u00a78\u00a7e\u00a7b\u00a7lr\u00a7x\u00a7f\u00a7f\u00a70\u00a74\u00a7f\u00a75\u00a7l!"
      GENERIC_PACK: "https://www.dropbox.com/s/cxggc0fvpow0hiw/BetterMCServer.zip?dl=1"
    volumes:
      - mc:/data
    tty: true
    stdin_open: true
    restart: unless-stopped
  monitor:
    container_name: monitor
    image: itzg/mc-monitor
    command: export-for-prometheus
    environment:
      EXPORT_SERVERS: minecraft-server
      DEBUG: "true"
    depends_on:
      - minecraft-server
  prometheus:
    image: prom/prometheus
    volumes:
      - ./prometheus.yml:/etc/prometheus/prometheus.yml
      - prometheus-tsdb:/prometheus
    depends_on:
      - monitor
  grafana:
    image: grafana/grafana-oss:${GRAFANA_VERSION:-8.3.3}
    ports:
      - "3000:3000"
    volumes:
      - grafana-lib:/var/lib/grafana
      - ./grafana/provisioning:/etc/grafana/provisioning
      - ./dashboards:/etc/grafana/dashboards
    depends_on:
      - prometheus



volumes:
  mc: {}
  prometheus-tsdb: {}
  grafana-lib: {}